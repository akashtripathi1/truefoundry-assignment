"use strict";(self.webpackChunktruefoundry_assignment=self.webpackChunktruefoundry_assignment||[]).push([[128],{"./src/stories/metrics/UsageGraph.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var _components_metrics_UsageGraph__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/components/metrics/UsageGraph.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");const __WEBPACK_DEFAULT_EXPORT__={title:"Metrics/UsageGraph",component:_components_metrics_UsageGraph__WEBPACK_IMPORTED_MODULE_1__.A},Default=(args=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_components_metrics_UsageGraph__WEBPACK_IMPORTED_MODULE_1__.A,{...args})).bind({});Default.args={title:"Sample Graph",data:{labels:["00:00","01:00","02:00","03:00","04:00","05:00"],datasets:[{label:"Dataset 1",data:[65,59,80,81,56,55],borderColor:"rgba(75,192,192,1)",fill:!1}],yMin:50,yMax:100}},Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => <UsageGraph {...args} />",...Default.parameters?.docs?.source}}};const __namedExportsOrder=["Default"]},"./src/components/metrics/UsageGraph.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),chart_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/chart.js/dist/chart.js"),_mui_material_Typography__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@mui/material/Typography/Typography.js"),_ViewLogs__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/components/metrics/ViewLogs.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");chart_js__WEBPACK_IMPORTED_MODULE_3__.t1.register(...chart_js__WEBPACK_IMPORTED_MODULE_3__.$L);const UsageGraph=_ref=>{let{title,data}=_ref;const chartRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),chartInstanceRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),[showViewLogs,setShowViewLogs]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),[logTimestamps,setLogTimestamps]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({start:null,end:null}),[dragStartIndex,setDragStartIndex]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),[dragEndIndex,setDragEndIndex]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null),[isDragging,setIsDragging]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!1),[viewLogsPosition,setViewLogsPosition]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({top:0,left:0}),[draggedDatasetIndex,setDraggedDatasetIndex]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(null);(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{chartRef.current&&!chartInstanceRef.current&&(chartInstanceRef.current=new chart_js__WEBPACK_IMPORTED_MODULE_3__.t1(chartRef.current.getContext("2d"),{type:"line",data:{labels:data.labels,datasets:data.datasets.map((dataset=>({...dataset,pointBackgroundColor:"rgba(0, 0, 0, 0.1)",pointBorderColor:"rgba(0, 0, 0, 0.1)",pointRadius:3,pointHoverBackgroundColor:"blue",pointHoverBorderColor:"blue",pointHoverRadius:7})))},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{},y:{suggestedMin:data.yMin,suggestedMax:data.yMax}},plugins:{legend:{display:!1},tooltip:{enabled:!1}}}}))}),[data]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{const chart=chartInstanceRef.current;chart&&null!==dragStartIndex&&null!==dragEndIndex&&null!==draggedDatasetIndex&&(chart.data.datasets.forEach(((dataset,index)=>{dataset.pointBackgroundColor=dataset.data.map(((_,dataIndex)=>index===draggedDatasetIndex&&dataIndex>=Math.min(dragStartIndex,dragEndIndex)&&dataIndex<=Math.max(dragStartIndex,dragEndIndex)?"orange":"rgba(0, 0, 0, 0.1)")),dataset.pointBorderColor=dataset.data.map(((_,dataIndex)=>index===draggedDatasetIndex&&dataIndex>=Math.min(dragStartIndex,dragEndIndex)&&dataIndex<=Math.max(dragStartIndex,dragEndIndex)?"orange":"rgba(0, 0, 0, 0.1)"))})),chart.update())}),[dragStartIndex,dragEndIndex,data.labels,draggedDatasetIndex]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{const canvas=chartRef.current,chart=chartInstanceRef.current,handleMouseDown=event=>{const points=chart.getElementsAtEventForMode(event,"nearest",{intersect:!0},!0);points.length&&(setIsDragging(!0),setDragStartIndex(points[0].index),setDragEndIndex(points[0].index),setDraggedDatasetIndex(points[0].datasetIndex))},handleMouseMove=event=>{if(!isDragging)return;const points=chart.getElementsAtEventForMode(event,"nearest",{intersect:!0},!0);points.length&&setDragEndIndex(points[0].index)},handleMouseUp=event=>{if(isDragging){const point=chart.getElementsAtEventForMode(event,"nearest",{intersect:!0},!0)[0];if(point){const{top,left}=chart.canvas.getBoundingClientRect(),pointMeta=chart.getDatasetMeta(point.datasetIndex).data[point.index];setViewLogsPosition({top:pointMeta.y+top,left:pointMeta.x+left})}}setIsDragging(!1)};return canvas&&(canvas.addEventListener("mousedown",handleMouseDown),canvas.addEventListener("mousemove",handleMouseMove),canvas.addEventListener("mouseup",handleMouseUp)),()=>{canvas&&(canvas.removeEventListener("mousedown",handleMouseDown),canvas.removeEventListener("mousemove",handleMouseMove),canvas.removeEventListener("mouseup",handleMouseUp))}}),[isDragging]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{if(!isDragging&&null!==dragStartIndex&&null!==dragEndIndex){const start=Math.min(dragStartIndex,dragEndIndex),end=Math.max(dragStartIndex,dragEndIndex),startTime=data.labels[start],endTime=data.labels[end];setLogTimestamps({start:startTime,end:endTime}),setShowViewLogs(!0)}}),[dragStartIndex,dragEndIndex,isDragging,data.labels]);const parseTimeToTimestamp=timeStr=>{const timeParts=timeStr.match(/(\d+):(\d+):(\d+)\s*(AM|PM)/i);if(!timeParts)return null;const now=new Date,hours=parseInt(timeParts[1])%12+("PM"===timeParts[4].toUpperCase()?12:0),minutes=parseInt(timeParts[2]),seconds=parseInt(timeParts[3]);return new Date(now.getFullYear(),now.getMonth(),now.getDate(),hours,minutes,seconds).getTime()};return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{if(null===dragStartIndex||null===dragEndIndex||isDragging)setShowViewLogs(!1);else{const startIndex=Math.min(dragStartIndex,dragEndIndex),endIndex=Math.max(dragStartIndex,dragEndIndex),startTime=parseTimeToTimestamp(data.labels[startIndex]),endTime=parseTimeToTimestamp(data.labels[endIndex]);setLogTimestamps({start:startTime,end:endTime}),setShowViewLogs(!0)}}),[dragStartIndex,dragEndIndex,isDragging,data.labels]),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_mui_material_Typography__WEBPACK_IMPORTED_MODULE_4__.A,{variant:"h6",component:"div",sx:{mb:2,textAlign:"left",color:"#2e2e2e"},children:title}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{style:{width:"590px",height:"334px",padding:"12px 16px 16px 16px",borderRadius:"8px",overflow:"hidden"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("canvas",{ref:chartRef,style:{width:"100%",height:"100%"}})}),showViewLogs&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("div",{style:{position:"absolute",top:viewLogsPosition.top,left:viewLogsPosition.left},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_ViewLogs__WEBPACK_IMPORTED_MODULE_1__.A,{startTimestamp:logTimestamps.start,endTimestamp:logTimestamps.end,onClick:()=>console.log("ViewLogs clicked")})})]})};UsageGraph.defaultProps={title:"Graph"};const __WEBPACK_DEFAULT_EXPORT__=UsageGraph;UsageGraph.__docgenInfo={description:"",methods:[],displayName:"UsageGraph",props:{title:{defaultValue:{value:"'Graph'",computed:!1},required:!1}}}},"./src/components/metrics/ViewLogs.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>metrics_ViewLogs});var react=__webpack_require__("./node_modules/react/index.js"),dist=__webpack_require__("./node_modules/react-router-dom/dist/index.js"),Button=__webpack_require__("./node_modules/@mui/material/Button/Button.js");var LiveFeedStatusContext=__webpack_require__("./src/context/LiveFeedStatusContext.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const ViewLogs=_ref=>{let{startTimestamp,endTimestamp,onClick}=_ref;const{setIsLive}=(0,LiveFeedStatusContext.o)();return(0,react.useEffect)((()=>{setIsLive(!1)}),[]),(0,jsx_runtime.jsx)("div",{onClick,style:{padding:"3px",background:"white",borderRadius:"6px",display:"inline-block"},children:(0,jsx_runtime.jsx)(dist.N_,{to:"/logs?start=".concat(startTimestamp,"&end=").concat(endTimestamp,"&live=",!1),style:{textDecoration:"none"},children:(0,jsx_runtime.jsx)(Button.A,{variant:"contained",startIcon:(0,jsx_runtime.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAxCAYAAAChzEtEAAAACXBIWXMAACxLAAAsSwGlPZapAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJXSURBVHgB7ZnLbdtAEEBnGCrw0SWog6SDxCUEiOVTbKYCKVc7BxqQdI1VQSTeogRIUkE+DcTpwCX47A/HM5QoC/aSXO6Hlg0+QNBilxSeZpf7GQK0tLS0PCkQGuDg6OsnQoqAYLvWjQjnkOJJMt49zquegWcyWaABF7egPlss/frFq7f4/++331IRgGeyyNr/SD8vhnkhir9vpxdXfQSKCKGr9UPcZUg4nY12P4BfVkMpizDLdtPLy3+AFGvLCjwmpbv3P36JSy6agEMyYZb9xV9dMGWty+6SDPdi7okJygPkgPDd4TwCG1kNkmFPHrrBel02BBeBegk1CBCLo6MNwazO5aayAg8Jqn1TTtbNSMfJuDfQvcdGVgiLGpJRz/miYisreJ+Hc3RkOUKnUEEjwrqy2OnsQAXehevITuM3lVOfV2HXsoI3YR+yghdhK1n1iriqcy5sH1nF3mNtYXIqrCWL8KNsGKzvPVQLUwgNynKoZrPhXgQVqPYeOc4irCObjKplq3AifHA4/wwNyArWwiLLm/6o+Ap3soKV8OI03JysYCW8PA0XtTqXFYxnieWsUNBaX3aVu2DKDrbGEZZ5VObU+y2GstJbkmipONhaDQkMO+9FMCvLJE8wMRkGytxFwcHWauFYrlbR8mOOOoWlTGs1duJwRSvsm1bYN62wbx6dcOHCsX80J9hAOMJYmR56CIrSVgFg+hM2EOR9iao+CMLnJ/xvzmCDEJ/puDdVtQXZNvH6emdTpMVDfErab4n49QEF2CcyT3KbsHj/gacE6R/p8bLU1Q03wS0jRo/xIgAAAABJRU5ErkJggg==",alt:"Logo",style:{maxWidth:"10px",maxHeight:"10px"}}),style:{backgroundColor:"black",color:"white",textTransform:"none",borderRadius:"6px",padding:"3px 9px",fontSize:"0.750rem"},children:"View logs"})})})},metrics_ViewLogs=ViewLogs;ViewLogs.__docgenInfo={description:"",methods:[],displayName:"ViewLogs"}},"./src/context/LiveFeedStatusContext.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{o:()=>useLiveFeedStatus,w:()=>LiveFeedStatusProvider});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");const LiveFeedStatusContext=(0,react__WEBPACK_IMPORTED_MODULE_0__.createContext)(),LiveFeedStatusProvider=_ref=>{let{children}=_ref;const[isLive,setIsLive]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(!0);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(LiveFeedStatusContext.Provider,{value:{isLive,setIsLive},children})},useLiveFeedStatus=()=>(0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(LiveFeedStatusContext);LiveFeedStatusProvider.__docgenInfo={description:"",methods:[],displayName:"LiveFeedStatusProvider"}}}]);